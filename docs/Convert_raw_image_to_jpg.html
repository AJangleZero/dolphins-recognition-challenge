---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "notebooks/utils/Convert_raw_image_to_jpg.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/utils/Convert_raw_image_to_jpg.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Set</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install progressbar2
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: progressbar2 in /root/.local/lib/python3.6/site-packages (3.53.1)
Requirement already satisfied: python-utils&gt;=2.3.0 in /root/.local/lib/python3.6/site-packages (from progressbar2) (2.4.0)
Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from progressbar2) (1.15.0)
<span class="ansi-yellow-fg">WARNING: You are using pip version 20.2.3; however, version 20.3.3 is available.
You should consider upgrading via the &#39;/usr/bin/python3 -m pip install --upgrade pip&#39; command.</span>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastcore.script</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">copy</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">progressbar</span>
<span class="kn">from</span> <span class="nn">progressbar</span> <span class="kn">import</span> <span class="n">FormatLabel</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">glob_suffixes</span><span class="p">(</span><span class="n">root_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">suffixes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">suffixes</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">suffixes</span> <span class="o">=</span> <span class="p">[</span><span class="n">suffixes</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">root_path</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;**/*&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">file_suffix_in</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">suffixes</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">traceback_with_variables</span> <span class="kn">import</span> <span class="n">activate_in_ipython_by_import</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">copytree</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dropbox_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/tf/airt/notebooks/images&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@call_parse</span>
<span class="k">def</span> <span class="nf">get_suffixes</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;input directory containing images&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="p">),</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Returns all unique suffixes&quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;**/*&quot;</span><span class="p">)</span>
    <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">p</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_file</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">files</span><span class="p">)))</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">files</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">actual</span> <span class="o">=</span> <span class="n">get_suffixes</span><span class="p">(</span><span class="n">dropbox_path</span><span class="p">)</span>

<span class="n">expected</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s2">&quot;.jpg&quot;</span><span class="p">,</span> <span class="s2">&quot;.png&quot;</span><span class="p">])</span>

<span class="k">assert</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">expected</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">actual</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;.jpg&#39;, &#39;.png&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_rand_file_with_suff</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">case_insensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a random file that has a suffix equal to the variable suff&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">case_insensitive</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**/*&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**/*</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">p</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_file</span><span class="p">()]</span>
    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">actual</span> <span class="o">=</span> <span class="n">get_rand_file_with_suff</span><span class="p">(</span><span class="n">dropbox_path</span><span class="p">,</span> <span class="s2">&quot;.JpG&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">actual</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">actual</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">actual</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;.jpg&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre>Path(&#39;/tf/airt/notebooks/images/Iou_example1.jpg&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_one_image_for_each_suffix</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Returns one random image for each suffix&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">get_rand_file_with_suff</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">suffix</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="n">get_suffixes</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">get_one_image_for_each_suffix</span><span class="p">(</span><span class="n">dropbox_path</span><span class="p">))</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_suffixes</span><span class="p">(</span><span class="n">dropbox_path</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
    <span class="n">get_one_image_for_each_suffix</span><span class="p">(</span><span class="n">dropbox_path</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre>[Path(&#39;/tf/airt/notebooks/images/Iou_example1.jpg&#39;),
 Path(&#39;/tf/airt/notebooks/images/AILeague_logo-800x452.png&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">create_sample_test_dir_if_needed</span><span class="p">(</span>
    <span class="n">dst</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;../data/testing/raw&quot;</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Creates samples for a test set&quot;&quot;&quot;</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">get_one_image_for_each_suffix</span><span class="p">(</span><span class="n">dropbox_path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">copy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">expected_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;../data/testing/raw&quot;</span><span class="p">)</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">create_sample_test_dir_if_needed</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">expected_path</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="n">actual</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[Path(&#39;../data/testing/raw/AILeague_logo-200x113.png&#39;),
 Path(&#39;../data/testing/raw/Iou_example1.jpg&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">convert_image_to_jpg_darktable</span><span class="p">(</span>
    <span class="n">img_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">suffixes_to_delete</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;.mov&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">],</span>
    <span class="n">remove_src</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">update_msg_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="nb">print</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">update_msg_fn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing </span><span class="si">{</span><span class="n">img_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Converts image whose suffix is not in the skip_suffixes list, if remove_src = True then deletes the input image&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">img_path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;.jpg&quot;</span><span class="p">:</span>
        <span class="n">dst</span> <span class="o">=</span> <span class="n">img_path</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="p">(</span><span class="n">img_path</span><span class="o">.</span><span class="n">stem</span> <span class="o">+</span> <span class="s2">&quot;.jpg&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">img_path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">suffixes_to_delete</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">remove_src</span><span class="p">:</span>
                <span class="n">retmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Removed </span><span class="si">{</span><span class="n">img_path</span><span class="si">}</span><span class="s2"> because </span><span class="si">{</span><span class="n">img_path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2"> is in </span><span class="si">{</span><span class="n">suffixes_to_delete</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">img_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">retmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Not removing </span><span class="si">{</span><span class="n">img_path</span><span class="si">}</span><span class="s2"> although </span><span class="si">{</span><span class="n">img_path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2"> is in </span><span class="si">{</span><span class="n">suffixes_to_delete</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">retmsg</span>
        <span class="k">if</span> <span class="n">dst</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">remove_src</span><span class="p">:</span>
            <span class="n">img_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
            <span class="n">retmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Removed </span><span class="si">{</span><span class="n">img_path</span><span class="si">}</span><span class="s2"> because </span><span class="si">{</span><span class="n">dst</span><span class="si">}</span><span class="s2"> exists.&quot;</span>
            <span class="k">return</span> <span class="n">dst</span><span class="p">,</span> <span class="n">retmsg</span>
        <span class="n">system_error</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;darktable-cli </span><span class="si">{</span><span class="n">img_path</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">dst</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">system_error</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">retmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Converted error </span><span class="si">{</span><span class="n">system_error</span><span class="si">}</span><span class="s2">, image path </span><span class="si">{</span><span class="n">img_path</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">return</span> <span class="n">img_path</span><span class="p">,</span> <span class="n">retmsg</span>
        <span class="k">if</span> <span class="n">remove_src</span><span class="p">:</span>
            <span class="n">img_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
        <span class="n">retmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Converted </span><span class="si">{</span><span class="n">img_path</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">dst</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">return</span> <span class="n">dst</span><span class="p">,</span> <span class="n">retmsg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">retmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Skiped path </span><span class="si">{</span><span class="n">img_path</span><span class="si">}</span><span class="s2"> because it is already a JPEG.&quot;</span>
        <span class="k">return</span> <span class="n">img_path</span><span class="p">,</span> <span class="n">retmsg</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">src_dir</span><span class="p">:</span>
    <span class="n">src_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">src_dir</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;raw&quot;</span>
    <span class="n">copytree</span><span class="p">(</span><span class="s2">&quot;../data/testing/raw/&quot;</span><span class="p">,</span> <span class="n">src_dir</span><span class="p">)</span>
    <span class="n">tif_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">src_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.png&quot;</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">new_tif</span> <span class="o">=</span> <span class="n">tif_path</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="p">(</span><span class="n">tif_path</span><span class="o">.</span><span class="n">stem</span> <span class="o">+</span> <span class="s2">&quot;_copy&quot;</span> <span class="o">+</span> <span class="n">tif_path</span><span class="o">.</span><span class="n">suffix</span><span class="p">)</span>
    <span class="n">copy</span><span class="p">(</span><span class="n">tif_path</span><span class="p">,</span> <span class="n">new_tif</span><span class="p">)</span>
    <span class="n">before_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">src_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)]</span>
    <span class="n">jpg_before</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">before_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;.jpg&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">image_path</span> <span class="ow">in</span> <span class="n">src_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
        <span class="n">dst</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">convert_image_to_jpg_darktable</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">remove_src</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">dst</span> <span class="ow">or</span> <span class="n">dst</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">after_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">src_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)]</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">before_files</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">after_files</span><span class="p">)</span> 
    <span class="n">display</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">before_files</span><span class="p">))</span>
    <span class="n">display</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">after_files</span><span class="p">))</span>
    <span class="n">jpg_after</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">after_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;.jpg&quot;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">jpg_after</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">jpg_before</span><span class="p">)</span> 

    <span class="k">for</span> <span class="n">img_after</span> <span class="ow">in</span> <span class="n">jpg_after</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">img_after</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;.jpg&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">img_after</span><span class="p">)</span>
            <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">img_after</span><span class="p">)</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Processing /tmp/tmpcs4m7toh/raw/AILeague_logo-200x113_copy.png
Converted error 32512, image path /tmp/tmpcs4m7toh/raw/AILeague_logo-200x113_copy.png.
Processing /tmp/tmpcs4m7toh/raw/AILeague_logo-200x113.png
Converted error 32512, image path /tmp/tmpcs4m7toh/raw/AILeague_logo-200x113.png.
Processing /tmp/tmpcs4m7toh/raw/Iou_example1.jpg
Skiped path /tmp/tmpcs4m7toh/raw/Iou_example1.jpg because it is already a JPEG.
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea ">
<pre>[Path(&#39;/tmp/tmpcs4m7toh/raw/AILeague_logo-200x113.png&#39;),
 Path(&#39;/tmp/tmpcs4m7toh/raw/AILeague_logo-200x113_copy.png&#39;),
 Path(&#39;/tmp/tmpcs4m7toh/raw/Iou_example1.jpg&#39;)]</pre>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea ">
<pre>[Path(&#39;/tmp/tmpcs4m7toh/raw/AILeague_logo-200x113.png&#39;),
 Path(&#39;/tmp/tmpcs4m7toh/raw/AILeague_logo-200x113_copy.png&#39;),
 Path(&#39;/tmp/tmpcs4m7toh/raw/Iou_example1.jpg&#39;)]</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/tmp/tmpcs4m7toh/raw/Iou_example1.jpg
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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Hac7OzvvuuuurVu33nTTTWvWrLEeTuVMaMeVXC43MDDwve99r6Ojw079t95665QpUw4fPrxw4UI7TzY0NOTz+V27do1l7eIiGmX7+vrsxpf9Uyn105/+9Dvf+U5zc/Njjz02b948G0OORmsAQggbxvz973//n//5n3Zomzlz5l133SWEaGlpue6667761a9G7qjtYcaYDRs2zJ8/f+bMmVEBtm3btnXr1r/8y7+cO3dutKOdZB1GxSsWi8VisfLigQMH1qxZ84c//OHqq6/+xje+0d/fbz246F7bOdPpdKlU+u53v/v+++/bafPmm29esWKFMebCCy9cu3atMcaG6I94FiIiNhHaMHflLsIDDzzws5/9DMA3v/nNz372s3aVUjmQBEGglMpkMrt37/7Hf/xHu2gEIIS48847i8ViS0uLvSWVSuVyucr1z9hVMg6imY3Lx4aYecuWLV/+8pftFt/DDz/8yCOPWAc1usuO03bY+vGPf/yv//qv9vqkSZOuv/76RYsWAbC9MxKhzXn37t2bNm1auXKlnW/tJ7766qta66uuuspuqSXf7HYwsuO4HVnsdSnlo48++vjjjwNoa2u77rrrrN0qu+Lhw4cBZDKZrq6uBx98MOqKSqkLL7zQvg7DMJVK5fN5lA8wHc0gse2r2h5jRxS7XfPcc89lMpmWlpZdu3b94he/OOecc4bcUigU0ul0fX19KpVasmTJvn37rO2WLVtm59LIU7VRKfnRr/eZkERL6GiX3F5RSj3zzDM9PT2zZs06ePDgL3/5y/vuu89OgyjbJAzDaOQ6++yz582bZ3tka2urvcjMdiEUhW1sT3rttde6u7s/8YlPoDzGM/NLL72Uy+UuvvjiylIlGa7Y9rQ6tFf279//5JNPKqVmzZr1zjvv/PznP//kJz9ZeRcRFQoFlB2uxYsX79u3z2a1YMGCKKXNsPoURDWxidC60VGfWLduXUdHx2233fY3f/M3N95445YtW+xC0arUxusOHTqklFJKTZs27cc//nHkQpx55pltbW2Vh49834983YmNXZNE+8WRPYvF4m9+85vJkyf/+7//+/PPP//tb3/7rbfesqEClAfmQqHg+77dZL/11lutqOyKffLkyfa4jA3qRB9nI4EbNmzI5XI2BGo/7sCBA1u2bFmwYIF1UO0yKQ57DIPK0ZnLZ/qEENu2bdu+ffvKlSvXrFnz13/916+//vpFF100JH2hUMhkMo2NjU1NTU888US06zN37txocRidW8LxDq/FIEJbLDtCROPl9u3bpZS33nrr+eef/7GPfWzXrl12sKl0pjs6OhoaGrLZbBAEUSzHYpfO1hbMbLetxsWhjZETnaKOwssADh8+vHPnzssvv/zyyy8Pw/Chhx7at2+fHZgjr3Xv3r2lUslOevX19UuWLInyDIIgsnx0FjwIAillsVh84YUXlixZMnv27OjT33333d27d1999dXW+6IjnYNLJtYm9vCaPWb0+uuvG2NWr169bNmyCy64YOPGjYVCYYiE3n333Wj7Yf78+ZVvRedOK0eiI550j4hBhFGLVnosH3zwQVNT04wZMwC0tLS0tbXZZAcOHLAJSqVSV1fX/PnzGxsbjTFtbW3WL7c+gBWn3UgUQtiZcPr06WNfu7HHRlM8z7PH92zDHzhwoL+//7zzzgNQX1/veV5fX59Sqru7u1gs2qW4PbO2cOFCm769vR3lc2e2Y9kRPVov2XNw7e3tb7755l133VV5YutPf/qT1vrSSy+NzQo1YR1RS3Q0dO/evZlMxjqWU6dOLRaLdlOnq6vL3qW13rVrV2tr66RJk7TWb7311uHDh213PeOMM+wZTJvMBqKP65nH447a2EkUptNa79+/XyllO4fV55QpUwC8//77AOyGaUdHhx2tOzo6brnllj179tj+8dWvfvULX/hCOp22rjmArq6uUqk0derUWGo39thRNnKoAPT39/u+H42+xphMJtPc3Lx9+3bf93O5nDFmx44d6XTazoSPP/749773PQDMPHfu3P/+7/+29rfToBWhnT83bdrk+/5ll12GcicWQmzcuDGTySxevDie+tdKZUgm2n+2PlQ0pQOYPn26HcVsgv7+/j179px99tnpdLqzs3PVqlV79uyxLsa999575513UvlkfBAE9hGTY8eK4xGh3cpEeQdCSjl9+nTf9214ff/+/U1NTXPmzEmn0++9955Nv3379s7OzgsuuADAwMDAtm3bIqPs3Lkzm83OmjVr8+bNdttw/fr1xpg5c+bEUruxJ/J/olCKjUvZ+LA98DFjxowzzzzzpZde6uzsbGhoIKK1a9fOnDnTWqm9vX337t02t76+vp6enpaWFru5j3J01Mr7V7/61YwZM5YvXx5FX7TWGzdunDFjRmtrayzVrxlb/nQ6bXViK5jP5wcGBuyI1tXVNWnSpDlz5tTV1f3xj39EuSvu3Llz9erVNk7xxhtvDAwM2AzffvttlD0Iz/M8z7O7i0jUsTVLsVi0nndbW9t//dd/2QX94cOH3377ba31G2+8ce2117a2tk6bNu2FF17o7u5ubm7+4Q9/mMlkbPx35syZDz74oN2DBnDDDTcopZYuXfof//EfL7744vLly5955plcLjdk3ThRsRPU7t27u7q6jDHPPffc6aeffs455zQ3N2/atMkY88ILL3ied/rpp59xxhmFQuGVV15ZsGDBxo0b161bd8MNN9TV1THzLbfcMnXqVBtOOO2001pbW21IbN26dbaxOjs7W1pauru7161bt3z58ubmZrv+9Dxv7969b7/99kUXXWQPfB17Tyw5WKn4vr9ly5YgCHbv3v3000/Pnj179uzZxWJx/fr1V1xxxYsvvrhs2bJZs2bNmTPn1Vdf/eCDD6ZPn/7Tn/5UCGHng5kzZ37nO9+xThmAv/iLv4hCrNu2bfN9f+3atStXrjx+UcaYIAjuvPPOuXPnKqXsSuaaa6556qmnlFIXXHDBlVdeCeDRRx9l5htuuEEIccMNN6xatSqTyVx00UX9/f1HO43+k5/8BMCCBQsuv/xyIrrsssv6+/ujc3ATFWuNl19+eenSpZMmTbIbFalU6umnn/7EJz6RyWT+6q/+qrm5+ayzzioWi6+88ko6nT7jjDNuu+22ZcuWAXjyySe5/GTAELTWv/3tb6dPn263+L/+9a8z85YtW/L5/D/90z9xxTHDl19+2Z7/OlpWicUY8/Wvf33+/Pme59n9m0suueR///d/M5nM2WefffXVVwOw9fryl78M4FOf+tTq1avr6+sXLly4f//+o+XJzHfeead1ImbMmLF169ZjFyMGER46dOj000+vHAj+7M/+rKOjw0YIALS0tOzcuZOZn3zyycpk3//+9/koTyf5vt/V1WXjEJYnnnjiaIknHg899NCQsfXZZ5999NFHoz/t80p9fX2XXHJJdPHss8/eu3dv9UNkEY888kiU+POf/zwz/9u//RsR/frXv65M9v3vfx/AU089xeNNhD09PUPcpSVLluzZs2fFihX2z3w+v379emb+7W9/W3lo+YEHHuAj9S57RWtt90str7zyyrGLEcNTFJlMZsWKFdu2bTvvvPOam5tLpdJVV101a9asu+++++///u+11vfcc09ra6vW+tOf/vTnPve5p556CsC11167cuXKox1KlFJOmTLlm9/85t13393T07Nq1arrr7/eDtUT+/l6Ziaic845Z+7cuXPmzFmwYAEz5/P55cuXX3jhhU8//fTatWuXL1/+pS99iZmz2eyaNWu++MUvdnV15fP5Bx54YPr06dEORDWf/OQnb7/9dnt+8qabbgLQ09NTV1dnn1KNgg25XK6hoWHp0qVjWvPRoK6ubsWKFUS0ZMmSadOm9ff3X3zxxTNmzLj33ntvu+22w4cP33HHHeeff749Ir969eof/OAHAK688sovfvGLfPRAixDiS1/60qJFi4jIuiHH9tLH+iEDW5p33nnH9/3Zs2dH56FsHGnLli3GmOXLl6dSKbvfsn///hdffPHAgQMrV66cMmWKPWZVveViFzBCiPb29u7u7iVLlkSPtNmI60SFme2xhJ07d06fPt1GU5i5VCql0+ldu3a1tbWdccYZc+bMCcPQelwbN2587bXXzjrrrCuuuIKZK79nZEjOlRftbsTmzZt//etf33vvvUopG1dk5n379v3f//3fVVddFT1AMKYmGAHM/P777x86dGjevHl2Vzl6sGvjxo3FYnHZsmX19fXWFN3d3b/5zW96enquueaaOXPmWAtXZxi9jgYp2zmj40rVxCBCrtgytp/u+749uh6dgbKbxfaQe1T0Uqlkz3xUP98UfWeRfYvLzzvbvjKWFRx77FNI9qso7Mxvn8QJwzAa4yoD5ZH17GmYyu+bqcS6VVT+6jqbLQCrPZtJdOwp+h63Yx8NSRo2Gh8ZxFbHHlGu/H6jqNNGN/b396dSqWpdRWqyt1hbHXdsikGEqPAnK7+KL/puospv7Kj8lr7o4pBHCu3Ab7eqUf4KMHtGYdx1i+ESSQUVu4XRSUhrq0oDRl9PZBPY6fEYIqwcLqnii7aGnNGJWmR8WdsYY2f4aISy3aby0aToscDIA+fy18wc48sO7Z92LrGZH+PEzFiLcMjHRe1a6fxEL6Kz51H9cZT9luitI/oDJ6cqCaL6kP4Q0w15ujRKeQyToqKxjtg6qOhzUebjy9qV1R/SxyqXypU98Nj9cEjmUc7HTj/xHzx3OBLOBF8vORzJx4nQ4YiZ/w+WeS3gzjwQ6AAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@call_parse</span>
<span class="k">def</span> <span class="nf">convert_files_with_darktable</span><span class="p">(</span>
    <span class="n">root_path</span><span class="p">:</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;input directory containing images to convert&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="p">),</span>
    <span class="n">remove_src</span><span class="p">:</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;input True if you want to delete the images &quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calls the convert_image_to_jpg() function on all images in the path&quot;&quot;&quot;</span>
    <span class="n">root_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">root_path</span><span class="p">)</span>
    <span class="n">widgets</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">FormatLabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="s2">&quot; [&quot;</span><span class="p">,</span>
        <span class="n">progressbar</span><span class="o">.</span><span class="n">Timer</span><span class="p">(),</span>
        <span class="s2">&quot;] &quot;</span><span class="p">,</span>
        <span class="n">progressbar</span><span class="o">.</span><span class="n">Bar</span><span class="p">(),</span>
        <span class="n">progressbar</span><span class="o">.</span><span class="n">Percentage</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%(percentage)5.2f%%</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="s2">&quot; (&quot;</span><span class="p">,</span>
        <span class="n">progressbar</span><span class="o">.</span><span class="n">AdaptiveETA</span><span class="p">(),</span>
        <span class="s2">&quot;) &quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">root_path</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;**/*&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_file</span><span class="p">()])</span>
    <span class="n">n_files</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_msg</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
        <span class="n">widgets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">FormatLabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">4d</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">n_files</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">log</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="n">progressbar</span><span class="o">.</span><span class="n">ProgressBar</span><span class="p">(</span><span class="n">max_value</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">),</span> <span class="n">widgets</span><span class="o">=</span><span class="n">widgets</span><span class="p">)</span> <span class="k">as</span> <span class="n">bar</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">src</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">files</span><span class="p">):</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">convert_image_to_jpg_darktable</span><span class="p">(</span>
                <span class="n">src</span><span class="p">,</span> <span class="n">remove_src</span><span class="o">=</span><span class="n">remove_src</span><span class="p">,</span> <span class="n">update_msg_fn</span><span class="o">=</span><span class="n">update_msg</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">bar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Conversion completed </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">log</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">src_dir</span><span class="p">:</span>
    <span class="n">src_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">src_dir</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;raw&quot;</span>
    <span class="n">copytree</span><span class="p">(</span><span class="s2">&quot;../data/testing/raw/&quot;</span><span class="p">,</span> <span class="n">src_dir</span><span class="p">)</span>
    <span class="n">copytree</span><span class="p">(</span><span class="s2">&quot;../data/testing/raw/&quot;</span><span class="p">,</span> <span class="n">src_dir</span> <span class="o">/</span> <span class="s2">&quot;jedan&quot;</span><span class="p">)</span>
    <span class="n">copytree</span><span class="p">(</span><span class="s2">&quot;../data/testing/raw/&quot;</span><span class="p">,</span> <span class="n">src_dir</span> <span class="o">/</span> <span class="s2">&quot;jedan&quot;</span> <span class="o">/</span> <span class="s2">&quot;dva&quot;</span><span class="p">)</span>
    <span class="n">copytree</span><span class="p">(</span><span class="s2">&quot;../data/testing/raw/&quot;</span><span class="p">,</span> <span class="n">src_dir</span> <span class="o">/</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>
    <span class="n">copytree</span><span class="p">(</span><span class="s2">&quot;../data/testing/raw/&quot;</span><span class="p">,</span> <span class="n">src_dir</span> <span class="o">/</span> <span class="s2">&quot;tri&quot;</span> <span class="o">/</span> <span class="s2">&quot;cetiri&quot;</span><span class="p">)</span>
    <span class="n">files_before</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">src_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;**/*&quot;</span><span class="p">))</span>

    <span class="c1"># the main thing</span>
    <span class="n">convert_files_with_darktable</span><span class="p">(</span><span class="n">src_dir</span><span class="p">,</span> <span class="n">remove_src</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">files_after</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">src_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;**/*&quot;</span><span class="p">))</span>

    <span class="k">assert</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">files_before</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">files_after</span><span class="p">)</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;len(</span><span class="si">{</span><span class="n">files_before</span><span class="si">}</span><span class="s2">) != len(</span><span class="si">{</span><span class="n">files_after</span><span class="si">}</span><span class="s2">)&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[   9/10] Processing /tmp/tmplhh89n8v/raw/tri/cetiri/Iou_example1.jpg [Elapsed Time: 0:00:00] ||100.00% (Time:  0:00:00) 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Conversion completed 10/10
Converted error 32512, image path /tmp/tmplhh89n8v/raw/AILeague_logo-200x113.png.
Skiped path /tmp/tmplhh89n8v/raw/Iou_example1.jpg because it is already a JPEG.
Converted error 32512, image path /tmp/tmplhh89n8v/raw/jedan/AILeague_logo-200x113.png.
Skiped path /tmp/tmplhh89n8v/raw/jedan/Iou_example1.jpg because it is already a JPEG.
Converted error 32512, image path /tmp/tmplhh89n8v/raw/jedan/dva/AILeague_logo-200x113.png.
Skiped path /tmp/tmplhh89n8v/raw/jedan/dva/Iou_example1.jpg because it is already a JPEG.
Converted error 32512, image path /tmp/tmplhh89n8v/raw/tri/AILeague_logo-200x113.png.
Skiped path /tmp/tmplhh89n8v/raw/tri/Iou_example1.jpg because it is already a JPEG.
Converted error 32512, image path /tmp/tmplhh89n8v/raw/tri/cetiri/AILeague_logo-200x113.png.
Skiped path /tmp/tmplhh89n8v/raw/tri/cetiri/Iou_example1.jpg because it is already a JPEG.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

